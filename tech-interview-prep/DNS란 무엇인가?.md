

## DNS 란?
- IP 주소는 변환될 수 있으며, 기억하기 어렵기 때문에 대부분의 웹 서비스는 도메인 주소를 사용합니다. 
- DNS(Domain Name System) 는 도메인 주소에 대응되는 원격 호스트 IP 주소를 관리하고 질의할 수 있는 시스템 혹은 이를 이용하기 위한 프로토콜을 의미합니다.
- DNS 시스템 내에서 도메인 주소를 관리하는 서버들을 네임 서버라고 부르며, 계층적인 형태로 존재합니다.

---

<br>



## DNS 질의 과정을 설명해 주세요.
- DNS를 이용해 IP 주소를 찾는 과정에는 로컬 네임 서버, 루트 네임 서버, TLD 네임 서버, 권한 네임 서버가 등장합니다.

#### 로컬 네임 서버(Local Name Server) 는 통신사 DNS, 구글 DNS 처럼 클라이언트와 가장 가까이 존재하는 네임 서버입니다.
#### 루트 네임 서버(Root Name Server) 는 루트 도메인을 관리하는 서버이며, TLD 네임 서버의 주소를 알고 있습니다.
#### TLD 네임 서버(Top-level Domain Server) 는 .com, .kr, .net을 관리하는 네임 서버입니다.
#### 권한 네임 서버(Authoriative Name Server) 는 네트워크를 운영하는 기관에서 보유하고 있는 도메인을 관리하는 네임 서버입니다. 
ex) .maeil-mail.kr을 관리하고, api.maeil-mail.kr, mail.maeil-mail.kr 의 정보를 관리하는 네임 서버 api.maeil-mail.kr의 IP 주소를 찾는 과정을 예시로 설명해 드리겠습니다.



## 순서
- 가장 먼저 클라이언트는 로컬 네임 서버에 api.maeil-mail.kr의 IP 주소를 질의합니다.
- 만약, 로컬 네임 서버에서 값을 찾지 못했다면 로컬 네임 서버는 루트 네임 서버에게 IP 주소를 물어봅니다.
- 요청을 받은 루트 네임 서버는 .kr TLD 네임 서버 주소를 응답합니다. 이를 받은 로컬 네임 서버는 .kr TLD 네임 서버에 다시 요청을 보내고, maeil-mail.kr 권한 네임 서버의 주소를 응답 받습니다.
- 최종적으로 로컬 네임 서버는 권한 네임 서버에서 api.maeil-mail.kr IP 주소를 받아서 클라이언트에게 응답합니다.


---


<br><br>



> ## 추가 학습자료

[10분 테코톡] 레디의 DNS
출처 : https://www.youtube.com/watch?v=X2hcteH8kR0


### 🚀 **DNS(Domain Name System)란?**
DNS는 **Domain Name System**의 약자로, **도메인 네임과 IP 주소를 매핑하는 시스템**입니다.  
도메인 네임은 사람이 이해하기 쉬운 문자열 주소(`www.google.com`), IP 주소(`142.250.74.14`)는 컴퓨터가 통신하는 실제 네트워크 주소입니다.  
DNS는 이러한 도메인과 IP를 변환해주는 역할을 하며, **트리(Tree) 구조**의 **분산 데이터베이스**를 사용합니다.

---
## 🛠 **DNS의 등장 배경**
초기 인터넷 환경에서는 모든 **호스트 정보**를 **하나의 텍스트 파일(hosts file)**로 관리했습니다.  
하지만 인터넷이 급격히 성장하며 **도메인과 IP 주소가 폭발적으로 증가**하면서 단일 텍스트 파일로 관리하는 것이 한계에 부딪혔습니다.  
이에 따라 **분산 데이터베이스 시스템인 DNS가 등장**하게 되었습니다.

---
## 🌲 **DNS의 트리 구조**
DNS는 **트리(Tree) 구조**를 가지고 있으며, 다음과 같은 계층으로 이루어져 있습니다.

### 📌 **DNS 계층 구조**
1️⃣ **루트 네임 서버 (Root Name Server)**  
   - 최상위 계층으로, 각 TLD(Top-Level Domain) 네임 서버의 위치 정보를 가지고 있음  
   - 예: `.com`, `.net`, `.org`, `.kr`  

2️⃣ **TLD(Top-Level Domain) 네임 서버**  
   - `.com`, `.org`, `.kr` 같은 최상위 도메인을 관리  
   - `google.com`의 경우 `.com` 네임 서버가 관리  

3️⃣ **서브 도메인 네임 서버 (Authoritative Name Server)**  
   - 개별 도메인(`google.com`)에 대한 IP 주소 정보를 가지고 있음  
   - 예: `blog.google.com`을 요청하면, `google.com` 네임 서버가 해당 서브 도메인의 IP 정보를 반환  

---
## 🌍 **DNS 조회 과정 (사용자가 웹사이트에 접속할 때 발생하는 과정)**

📌 **예제:** 사용자가 `www.reddy.com`을 입력하면?  

1️⃣ **브라우저 캐시 확인**  
   - 브라우저는 먼저 **자신의 캐시에 저장된 DNS 정보**를 확인  
   - 최근 방문한 사이트라면 **DNS 요청 없이 바로 IP 주소를 사용**  
   - 캐시 만료 시 다음 단계 진행  

2️⃣ **로컬 호스트 파일(hosts file) 확인**  
   - 운영체제(OS)가 `C:\Windows\System32\drivers\etc\hosts` 또는 `/etc/hosts` 파일을 확인  
   - 수동으로 지정한 도메인-아이피 매핑이 있으면 이를 사용  

3️⃣ **로컬 DNS 서버 요청 (ISP 캐시 확인)**  
   - ISP(인터넷 제공업체)의 DNS 서버에서 캐시된 IP 주소 확인  
   - 만약 존재하지 않으면 DNS 쿼리를 상위 네임 서버로 전달  

4️⃣ **DNS 계층적 조회 (루트 → TLD → 서브 도메인 네임 서버)**
   - **루트 네임 서버** → `.com` 네임 서버 주소 반환  
   - **TLD 네임 서버** → `reddy.com` 네임 서버 주소 반환  
   - **서브 도메인 네임 서버** → `www.reddy.com`의 IP 주소 반환  

5️⃣ **IP 주소 반환 후 서버에 접속**  
   - **클라이언트는 해당 IP 주소를 사용해 웹 서버에 접속**  
   - 이후, 웹사이트의 HTML, CSS, JS 리소스를 다운로드하여 페이지를 표시  

---
## 🔄 **재귀(Recursive) vs 반복(Iterative) DNS 조회 방식**
### 🔹 **재귀(Recursive) 쿼리**
   - 브라우저 → 로컬 DNS 서버로 요청  
   - 로컬 DNS 서버가 최종 응답을 찾을 때까지 **다른 DNS 서버와 통신하여 최종 결과를 반환**  
   - 성능 최적화를 위해 **TTL(Time To Live) 값 동안 캐싱 가능**  

📌 **비유:** "친구에게 어떤 가게를 물어보면, 친구가 직접 여러 사람에게 물어보고 답을 찾아와 주는 것"  

### 🔹 **반복(Iterative) 쿼리**
   - 로컬 DNS 서버 → 루트 네임 서버에 요청  
   - 루트 네임 서버는 **최종 결과가 아닌 "다음 네임 서버"의 위치만 반환**  
   - 로컬 DNS 서버가 다시 TLD 네임 서버에 요청 → 서브 도메인 네임 서버로 요청  

📌 **비유:** "친구에게 길을 물어보면, 친구는 직접 가게를 찾아주지는 않고 '저쪽 길 끝에서 왼쪽으로 가면 다른 사람이 알려줄 거야'라고 말하는 것"  

---
## 📡 **DNS 프로토콜 (UDP vs TCP)**
**🔹 DNS는 왜 UDP를 사용할까?**  
DNS는 일반적으로 **UDP(User Datagram Protocol)를 사용**합니다.  

📌 **이유:**  
✅ **빠른 응답 속도**  
   - TCP는 **3-way Handshake 과정**(SYN → SYN-ACK → ACK)이 필요하여 속도가 느림  
   - 반면, UDP는 **바로 데이터를 전송**하여 응답 속도가 빠름  

✅ **연결 유지가 불필요**  
   - DNS 서버와 클라이언트는 **일회성 통신**을 하므로 지속적인 연결(TCP)이 필요 없음  

✅ **패킷 크기가 작음**  
   - 대부분의 DNS 응답 패킷 크기는 **512바이트 이하**이므로 UDP로도 충분  

📌 **비유:**  
📬 **엽서 보내기 vs 등기우편**  
- UDP는 **엽서**처럼 바로 보낼 수 있지만,  
- TCP는 **등기우편**처럼 서명을 받고 전달 확인을 해야 함  

---
## 🚀 **DNS가 TCP를 사용하는 경우**
1️⃣ **DNS 영역 전송(Zone Transfer)**
   - 기본 DNS 서버(Primary DNS)와 보조 DNS 서버(Secondary DNS) 간의 **데이터 동기화**  
   - 신뢰성과 데이터 무결성이 중요하므로 **TCP 사용**  

2️⃣ **512바이트를 초과하는 DNS 패킷**
   - UDP는 기본적으로 512바이트까지만 전송 가능  
   - 더 큰 데이터는 **TCP를 사용하여 신뢰성 있게 전달**  

📌 **비유:**  
📁 작은 파일(UDP)은 메일 첨부파일로 보내지만,  
📦 큰 파일(TCP)은 클라우드 스토리지로 업로드 후 다운로드하는 것과 유사  

---
## 🔥 **심화 면접 질문 (기술 면접 대비)**
❓ **Q1. DNS 캐싱이란 무엇이며, TTL(Time To Live)이 중요한 이유는?**  
💡 **답변:**  
- DNS 캐싱은 **DNS 조회 결과를 일정 시간 동안 저장**하여 불필요한 요청을 줄이는 기술  
- TTL은 캐시 유지 시간을 결정하며, **TTL이 짧으면 자주 업데이트하지만, 서버 부하가 증가**  

❓ **Q2. DNS가 DDoS 공격의 대상이 되는 이유는?**  
💡 **답변:**  
- 공격자는 **DNS 서버에 대량의 요청을 보내 과부하를 유발(DNS Flooding)**  
- DNS 캐시 포이즈닝(Caching Poisoning) 기법으로 **사용자를 가짜 사이트로 유도**  

❓ **Q3. DNS over HTTPS(DoH)와 DNS over TLS(DoT)의 차이점은?**  
💡 **답변:**  
- **DoH (DNS over HTTPS)**: DNS 요청을 **HTTPS 트래픽으로 암호화하여 전송**  
- **DoT (DNS over TLS)**: **TLS 암호화를 통해 보안성을 높인 DNS 요청**  

---
## 🎯 **정리**
✅ DNS는 **도메인과 IP 주소를 매핑하는 시스템**  
✅ **트리 구조**를 가지며, **루트 → TLD → 서브 도메인 네임 서버**로 구성  
✅ **재귀 쿼리 vs 반복 쿼리**를 활용하여 빠르게 IP 주소를 찾음  
✅ 일반적인 DNS 요청은 **UDP 사용**, 하지만 **영역 전송 또는 큰 패킷**의 경우 **TCP 사용**  
✅ **DNS 캐싱과 TTL을 활용하여 성능 최적화 가능**  
✅ **DNS 보안 이슈(DDoS, 캐시 포이즈닝)와 최신 보안 기술(DoH, DoT) 이해 필요**  

이제 DNS에 대한 개념을 명확히 이해하고, 기술 면접에서도 깊이 있는 답변을 할 수 있도록 대비해 보세요! 🚀

