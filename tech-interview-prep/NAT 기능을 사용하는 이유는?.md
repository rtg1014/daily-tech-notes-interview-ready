## NAT
- NAT는 IP 주소를 변환하는 기술입니다.


- IP 주소는 공인 IP 주소(Public IP Address) 와 사설 IP 주소(Private IP Address) 가 존재합니다. 

- 공인 IP 주소는 고유하며, 사설 IP 주소는 고유하지 않고 특정 사설 네트워크에서만 사용됩니다. 이때, 사설 네트워크는 외부 네트워크에 공개되지 않은 네트워크를 의미합니다. 
- 사설 IP는 일반적으로 라우터가 할당하며, 할당받은 사설 IP 주소는 사설 네트워크 상에서만 유효합니다.

- 사설 IP 주소만을 가지고 외부 네트워크와 통신하기 어렵습니다. 
- 이 문제를 해결하기 위해서 라우터 혹은 공유기의 NAT(Network Address Translation) 기능을 사용하는데요.
- NAT는 IP 주소를 변환하는 기술입니다. 해당 기능을 사용하면, 사설 IP 주소를 외부 네트워크에 사용되는 공인 IP 주소로 변환하여 외부 네트워크와 통신할 수 있습니다.

- 예를 들어, 사설 네트워크에서 출발한 패킷에 존재하는 사설 IP 주소(송신지)가 라우터를 거쳐 공인 IP로 변경됩니다.
- 그리고, 외부 네트워크로부터 출발한 패킷에 존재하는 공인 IP 주소(수신지)는 NAT 기능을 통해서, 사설 IP 주소로 변경되고 사설 네트워크 속 호스트에게 전달됩니다.
- NAT에서 주소 변환을 하기 위해서 내부적으로 공인 IP 주소와 사설 IP 주소가 대응되어 있는 NAT 변환 테이블을 사용합니다.

---


## NAT 변환 테이블에서 공인 IP 주소와 사설 IP 주소는 일대일로 대응되어 있나요? 
- 일대일 대응이라면 사설 IP 주소만큼 공인 IP가 필요하기 때문에 한계가 있습니다.
- 따라서, 일반적으로 공인 IP와 사설 IP가 일대일로 대응하지 않고, NAPT(Network Address Port Translation) 이라는 포트 기반의 NAT를 사용합니다.
- 해당 기능에서는 NAPT 변환 테이블에 IP 주소 쌍과 함께 포트도 함께 기록됩니다. 다음은 NAPT 변환 테이블의 예시입니다.


| Private  IP	 | Private Port | Public IP | Public Port |
|------|------|----------|------|
192.168.10.2 |	8000 | 	1.2.3.4	 | 8001 |
192.168.10.3 |	8000 | 	1.2.3.4 |	8002 |


<br>

---

<br>

> ## 추가학습

[10분 테코톡] 애쉬의 AWS 살짝 알은체 하기
출처 : https://www.youtube.com/watch?v=tkP5u_SrF-8


### **📌 AWS 기초 개념 - 쉽게 이해하는 EC2와 네트워크 개념**
우아한테크코스 백엔드 4기 애쉬의 **AWS 살짝 알은체 하기** 발표 내용을 정리한 문서입니다.  
AWS 입문자에게 꼭 필요한 **EC2 설정 과정과 네트워크 개념**을 쉽고 명확하게 설명합니다.  
**비유와 시각적 자료를 추가하여 AWS 개념을 더 쉽게 이해할 수 있도록 구성했습니다.** 🚀

---

# **🌍 AWS란?**
AWS(Amazon Web Services)는 **아마존이 제공하는 클라우드 서비스**입니다.  

### **✔ 클라우드 컴퓨팅이란?**  
> 클라우드 컴퓨팅은 **인터넷을 통해 강력한 컴퓨터를 빌려 쓰는 것**  

🎯 **왜 클라우드를 사용할까?**  
✅ 내 컴퓨터 성능이 낮아도 강력한 서버를 빌려서 사용 가능  
✅ 직접 서버를 구매하지 않고 사용한 만큼만 비용 지불  
✅ 전 세계 어디서나 빠르게 서비스를 배포 가능  

💡 **AWS는 클라우드 시장 점유율 1위, 한국에서도 점유율 50% 이상!**  

---

# **🚀 EC2 (Elastic Compute Cloud) - AWS의 가상 서버**
> **EC2 = 클라우드에서 빌려 쓰는 컴퓨터 한 대**  

💡 **EC2 이름 속 의미**  
✔ **Elastic** → 서버 크기를 쉽게 조절할 수 있음  
✔ **Compute Cloud** → 컴퓨터를 클라우드에서 제공  

📌 **EC2는 컴퓨터를 빌리는 서비스**  
✔ 일반 컴퓨터처럼 CPU, RAM, 스토리지를 갖춘 가상 서버  
✔ 원하는 사양에 따라 선택 가능 (예: 고성능, 저비용 등)  
✔ 💰 **사용한 만큼만 비용을 지불**하면 됨  

---

# **📍 AWS 리전(Region)과 가용 영역(AZ)**
> **전 세계에 퍼져있는 AWS 데이터센터를 효과적으로 관리하는 방식**

## **🏢 리전(Region) - AWS 데이터센터 그룹**
✔ AWS는 전 세계 여러 지역(Region)에 **데이터센터**를 운영  
✔ 서울 리전 포함, **각 리전은 여러 개의 가용 영역(AZ)**을 포함  

📌 **예시**  
📍 **서울 리전**  
📍 **도쿄 리전**  
📍 **북미 리전**  

---

## **🏬 가용 영역(AZ) - 개별 데이터센터**
✔ **하나의 리전 내 여러 개의 가용 영역(AZ, Availability Zone)이 존재**  
✔ **각 가용 영역(AZ)은 물리적으로 다른 위치에 있는 데이터센터**  
✔ 데이터센터가 하나만 있으면 **지진, 정전 등으로 서버가 다운될 위험**  

💡 **AWS는 안전성을 위해 한 리전에 최소 2개 이상의 AZ 운영!**  
(예: 서울 리전에는 4개의 가용 영역이 있음)

---

# **🏠 VPC (Virtual Private Cloud) - AWS의 가상 네트워크**
> **VPC = AWS 내에서 나만의 네트워크 공간**  

✔ 사용자가 직접 네트워크를 설정할 수 있는 **AWS 내부의 가상 공간**  
✔ 같은 리전 내의 여러 가용 영역(AZ)들을 하나의 VPC로 연결  

💡 **비유: VPC는 AWS 속 "우리 집"**  
🏠 **우리 집(VPC)** 안에는 여러 개의 방(AZ)이 있음  
🚪 **우리 집 출입문(인터넷 게이트웨이)**이 있어야 인터넷과 연결 가능  

---

# **🛤 AWS 네트워크 흐름 - 인터넷이 EC2에 도달하는 과정**
> 인터넷에서 EC2 인스턴스로 트래픽이 도달하는 **경로를 따라가 보자!**

📌 **비유: 할머니 집 가는 길 🚗**  
> 차를 타고 할머니네 집(EC2)까지 가는 과정을 생각해보세요!  

---

## **🚦 1️⃣ 인터넷 게이트웨이 (Internet Gateway) - 톨게이트 🚗**
✔ 인터넷과 **AWS 내부 네트워크를 연결하는 출입구**  
✔ VPC가 **인터넷과 연결되려면 반드시 필요**  

📌 **비유**  
🏠 **우리 집(VPC)에서 외출하려면 톨게이트(인터넷 게이트웨이)를 통과해야 함!**  

---

## **📍 2️⃣ 라우트 테이블(Route Table) - 표지판 🛣**
✔ **어떤 인터넷 트래픽이 어디로 가야 하는지 안내하는 지도**  
✔ 라우터(Router)가 **라우트 테이블을 참고해 트래픽을 올바른 방향으로 보냄**  

📌 **비유**  
🚧 **도로 표지판(Route Table)이 있어야 우리가 어디로 가야 할지 알 수 있음!**  

---

## **🛑 3️⃣ NACL (Network Access Control List) - 동네 검문소**
✔ **서브넷(Subnet) 단위의 네트워크 보안 시스템**  
✔ 서브넷(Subnet) 안으로 들어오는 트래픽을 제한하거나 허용 가능  

📌 **비유**  
🚓 **동네 입구에서 경찰이 차량을 검사하는 검문소처럼, 서브넷에 들어오기 전 트래픽을 검사!**  

---

## **🐕 4️⃣ 보안 그룹(Security Group) - 집 앞의 경비견 🐕**
✔ **EC2 인스턴스 단위의 방화벽**  
✔ 특정 트래픽만 허용하도록 설정 가능  

📌 **비유**  
🏡 **우리 집 앞 마당(EC2)에는 집을 지키는 경비견(Security Group)이 있음!**  

✅ **NACL vs 보안 그룹 차이점**
| 구분 | NACL (검문소) | 보안 그룹 (집 앞 개) |
|------|--------------|------------------|
| 적용 범위 | 서브넷 단위 | 인스턴스 단위 |
| 트래픽 규칙 | 허용 & 거부 가능 | 허용만 가능 |

---

# **🔑 퍼블릭 vs 프라이빗 서브넷**
✔ **퍼블릭 서브넷**  
- 외부 인터넷과 연결됨  
- EC2가 퍼블릭 IP를 가질 수 있음  

✔ **프라이빗 서브넷**  
- 외부 인터넷과 연결되지 않음  
- 보안이 필요한 **데이터베이스 서버**에 적합  

---

# **📡 NAT 게이트웨이 (NAT Gateway) - 인터넷 공유기**
✔ 프라이빗 서브넷에 있는 EC2가 인터넷에 접근할 수 있도록 돕는 서비스  
✔ 프라이빗 서브넷에서는 직접 인터넷에 연결할 수 없기 때문에 **NAT 게이트웨이가 중간 역할**  

📌 **비유**  
🏠 **우리 집에 있는 공유기(NAT Gateway)를 통해 내부 네트워크(프라이빗 서브넷)에서도 인터넷을 사용할 수 있음!**  

---

# **📌 최종 정리**
✔ **AWS = 클라우드에서 빌려 쓰는 컴퓨터**  
✔ **EC2 = 가상 서버 (내 컴퓨터 대신 사용)**  
✔ **VPC = AWS 내 우리 집 (네트워크 공간)**  
✔ **NACL(서브넷 보안) vs 보안 그룹(EC2 보안)**  
✔ **퍼블릭 서브넷(인터넷 연결 O) vs 프라이빗 서브넷(인터넷 연결 X)**  
✔ **NAT 게이트웨이 = 인터넷 공유기 역할**  

---


<Br>
<br>

<br>


---


> ## 학습자료 추가

AWS를 사용한다면 반드시 알아야 할 네트워크 기초 지식
출처 : https://www.youtube.com/watch?v=vCNexbgYmQ8


### **📌 AWS VPC 네트워크 구조 - 쉽게 이해하는 VPC 설계 전략**  
AWS 솔루션즈 아키텍트 **이지호**의 발표 내용을 정리한 문서입니다.  
**VPC 중심으로 AWS 네트워크를 어떻게 설계하고 보호할 수 있는지** 쉽게 이해할 수 있도록 **비유와 시각 자료를 추가하여 구성했습니다.** 🚀  

---

# **🌍 VPC란?**
> **VPC (Virtual Private Cloud) = AWS에서 제공하는 가상의 독립된 네트워크 환경**  

✔ 기존 **온프레미스 데이터센터와 유사**하지만, 물리적으로 존재하는 네트워크 인프라가 아님  
✔ **AWS에서 완전하게 독립된 네트워크 환경**을 만들 수 있음  
✔ 서브넷, 라우트 테이블, 방화벽 설정을 통해 **네트워크 흐름을 직접 제어 가능**  

📌 **VPC는 AWS 네트워크의 기본 단위!**  
✔ 여러 개의 가용 영역(AZ)에 걸쳐 **하나의 VPC를 생성 가능**  
✔ 퍼블릭 및 프라이빗 서브넷을 분리하여 보안 강화  

---

# **🏢 AWS 네트워크 자원의 계층 구조**
> AWS 리소스는 **리전 → 가용 영역(AZ) → VPC → 서브넷** 순으로 구성됨  

| **계층** | **설명** | **예시** |
|---------|--------|--------|
| **글로벌(Global Level)** | AWS 전체에서 공유됨 | IAM, Route 53 |
| **리전(Region Level)** | 특정 리전에 속함 | EC2, RDS |
| **가용 영역(AZ Level)** | 리전 내 개별 데이터센터 | 서울 리전의 AZ-a, AZ-b |
| **VPC(Virtual Private Cloud)** | 특정 리전 내의 네트워크 환경 | **서버(EC2), 데이터베이스(RDS) 배포 가능** |
| **서브넷(Subnet Level)** | VPC 내의 작은 네트워크 영역 | 퍼블릭 / 프라이빗 서브넷 |

📌 **VPC는 리전 단위의 서비스**  
✔ 리전 내의 **모든 AZ를 하나의 VPC로 관리 가능**  
✔ 온프레미스 환경처럼 서브넷을 나누고, 방화벽을 설정하여 보안 강화  

---

# **🏗 VPC 기본 구조 - AWS가 제공하는 디폴트 VPC**
> AWS를 처음 사용할 때 자동으로 생성되는 **디폴트(Default) VPC**  

✔ **리전마다 기본적으로 하나의 VPC 제공**  
✔ 모든 **서브넷이 퍼블릭 서브넷**으로 구성됨  
✔ **인터넷과 연결된 인터넷 게이트웨이(IGW) 포함**  

📌 **디폴트 VPC의 기본 설정**  
- **CIDR: 172.30.0.0/16**  
- **각 AZ에 하나의 서브넷 배치 (퍼블릭 서브넷)**  
- **모든 서브넷은 기본적으로 인터넷 연결 가능**  

📌 **보안 구성 요소**  
| **보안 구성 요소** | **설명** |
|----------------|----------------------|
| **라우트 테이블(Route Table)** | 네트워크 트래픽을 어디로 보낼지 결정 |
| **인터넷 게이트웨이(IGW)** | VPC가 외부 인터넷과 통신할 수 있도록 연결 |
| **NACL (Network ACL)** | 서브넷 단위의 방화벽 |
| **보안 그룹(Security Group)** | 개별 인스턴스(EC2) 단위의 방화벽 |

💡 **디폴트 VPC는 모든 인스턴스가 인터넷과 연결됨 → 보안 강화를 위해 커스텀 VPC 사용 권장!**  

---

# **🚀 커스텀 VPC 설계 전략**
> **AWS를 실제 운영할 때는 보안을 위해 새로운 VPC를 직접 설계해야 함!**  

✔ **VPC를 직접 생성하여 보안과 네트워크 효율성을 최적화**  
✔ 서브넷을 **퍼블릭/프라이빗으로 분리**하여 보안 강화  
✔ **라우트 테이블을 활용하여 네트워크 트래픽을 효율적으로 관리**  

## **1️⃣ VPC의 CIDR 블록을 정하기**
✔ VPC의 네트워크 범위를 CIDR(Classless Inter-Domain Routing) 형식으로 설정  
✔ AWS에서는 **IPv4(16~28bit) 또는 IPv6 사용 가능**  
✔ 일반적으로 **10.0.0.0/16, 172.16.0.0/16**과 같은 **사설 IP 대역**을 사용  

💡 **비유: VPC의 CIDR 설정은 우리 집 주소를 정하는 것!**  
🏠 **집(VPC)** → **각 방(서브넷)마다 고유한 주소(IP 범위)가 필요!**  

---

## **2️⃣ 퍼블릭 서브넷 vs 프라이빗 서브넷 분리**
> **보안 강화를 위해 인터넷과 연결된 서브넷과 내부 전용 서브넷을 구분해야 함**  

✔ **퍼블릭 서브넷 (Public Subnet)**
- 인터넷과 직접 연결됨  
- EC2 웹 서버, ALB(NLB) 등을 배치  
- IGW(인터넷 게이트웨이)와 연결되어 있음  

✔ **프라이빗 서브넷 (Private Subnet)**
- 인터넷과 직접 연결되지 않음  
- 데이터베이스(RDS), 내부 애플리케이션 서버 배치  
- 보안을 위해 NAT 게이트웨이(NAT Gateway) 또는 VPC 엔드포인트 사용  

📌 **설정 방식**
| 서브넷 | 인터넷 연결 | 사용 예시 |
|---------|------------|-------------|
| **퍼블릭 서브넷** | O | 웹 서버, ALB |
| **프라이빗 서브넷** | X | 데이터베이스, 내부 서버 |

💡 **비유: 퍼블릭 서브넷 = 대문이 열려있는 집, 프라이빗 서브넷 = 보안이 철저한 금고**  

---

## **3️⃣ NAT 게이트웨이 (NAT Gateway)**
> **프라이빗 서브넷에서 인터넷에 접근할 수 있도록 중간 역할을 하는 장치**  

✔ 프라이빗 서브넷의 인스턴스가 **인터넷에 접속할 수 있도록 IP 변환 수행**  
✔ 보안 강화를 위해 **외부에서는 프라이빗 서브넷을 직접 접근할 수 없음**  

📌 **비유: NAT Gateway는 공유기 역할**  
🏠 **우리 집(프라이빗 서브넷)에서 인터넷에 접속하려면 공유기(NAT) 필요!**  

---

# **📌 네트워크 보안 - NACL vs 보안 그룹**
> **NACL과 보안 그룹은 AWS에서 트래픽을 제어하는 핵심 방화벽 역할!**  

✔ **NACL (Network ACL)**
- **서브넷 레벨**에서 네트워크 트래픽 제어  
- **허용 & 거부 규칙 가능**  
- **순서대로 규칙을 평가 (번호가 낮을수록 우선 적용됨)**  

✔ **보안 그룹 (Security Group)**
- **EC2 인스턴스 단위**에서 트래픽 제어  
- **허용 규칙만 가능 (거부 규칙 없음)**  
- **자동으로 상태 저장 (Stateful)**  

📌 **비유:**
🚧 **NACL = 동네 입구의 검문소 (서브넷 단위 보안)**  
🐕 **보안 그룹 = 우리 집 앞 경비견 (EC2 단위 보안)**  

---

# **📡 VPC 엔드포인트 - 내부 AWS 서비스와 연결**
> **VPC 내부에서 AWS 서비스(S3, DynamoDB 등)에 직접 연결하는 방법**  

✔ **게이트웨이 엔드포인트 (Gateway Endpoint)**
- S3, DynamoDB와 같은 서비스와 직접 연결  
- 인터넷 게이트웨이를 거치지 않으므로 **보안 강화 & 비용 절감**  

✔ **인터페이스 엔드포인트 (Interface Endpoint)**
- AWS의 다양한 서비스 (SNS, SQS, Lambda 등)와 연결 가능  
- 내부 네트워크를 통해 AWS 서비스에 연결  

---

# **📌 마무리 - AWS 네트워크 설계 요약**
✔ **VPC = AWS에서 제공하는 가상의 네트워크 공간**  
✔ **퍼블릭 vs 프라이빗 서브넷을 나누어 보안 강화**  
✔ **NACL(서브넷 방화벽) vs 보안 그룹(인스턴스 방화벽) 차이점 이해**  
✔ **NAT 게이트웨이를 통해 프라이빗 서브넷이 인터넷 접근 가능**  
✔ **VPC 엔드포인트로 내부 네트워크에서 AWS 서비스와 연결 가능**  

🎯 **이제 AWS 네트워크를 설계할 때 무엇을 고려해야 할지 이해할 수 있습니다!** 🚀


