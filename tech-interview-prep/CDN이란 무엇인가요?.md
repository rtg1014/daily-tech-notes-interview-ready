### CDN 이란?
- 콘텐츠 전송 네트워크(Content Delivery Network, CDN) 은 전 세계에 분산된 서버 네트워크며, 사용자와 물리적으로 가까운 위치에서 정적 콘텐츠(혹은 동적 콘텐츠)를 제공하여 서버 과부하를 방지하고 통신 지연을 단축합니다.
- CDN은 통신에 참여하는 호스트 간에 중간 서버를 두어 성능을 향상합니다.
- 대표적인 CDN 서비스로는 CloudFront, CloudFlare 등이 있습니다.


<br>

---

<br>

  

### CDN에서 Push 방식과 Pull 방식의 차이점은 무엇인가요? 
#### Push 방식
- Push 방식은 원본 서버가 콘텐츠를 미리 CDN 서버로 전달하는 방식입니다.
- Push 방식은 적절한 시기에 정확한 콘텐츠를 제공할 수 있습니다. 하지만, 지속적으로 업데이트를 해줘야 한다는 점에서 관리 비용이 상대적으로 높습니다.


<br>


#### Pull 방식
- Pull 방식은 CDN 서버가 원본 서버로 요청을 보내 콘텐츠를 가져오는 방식입니다.
- 클라이언트가 요청을 보내는 경우, CDN에 원하는 콘텐츠가 없다면 원본 서버로부터 콘텐츠를 가져와서 업데이트하는 방식으로 동작합니다.
- 초기 요청에서는 원본 서버에서 콘텐츠를 가져오는 작업을 수행해야 하므로 응답 속도가 저하될 수 있습니다.



<br>

---

<br>

  



### CDN을 사용해야 할 때 고려해야 할 점은 무엇인가요? 
- CDN을 사용해야 할 때는 크게 비용, 만료 시간, CDN 장애 대응, 콘텐츠 무효화를 고려해야 합니다.

<br>

#### 1. CDN은 주로 제 3 사업자(클라우드 서비스 등)에게 비용을 지불하고 사용합니다.
- 비용 대비 효과를 고려하여 비판적으로 도입하고, 성능 향상이 필요한 콘텐츠만 캐싱하는 등 비용을 절약하기 위한 고민이 필요합니다.


#### 2. 콘텐츠의 적절한 만료 시간에 대해서 고려해야 합니다.
- 콘텐츠의 만료 시간이 길다면 신선도가 떨어지며, 짧다면 원본 서버로의 요청이 빈번해집니다.


#### 3. CDN에 장애가 발생했을 때 어떻게 대응해야 할지 고려해야 합니다. 
- 예를 들어, CDN에서 콘텐츠를 응답할 수 없는 경우, 클라이언트에서 원본 서버로부터 직접 콘텐츠를 가져오도록 구성할 수 있습니다.


#### 4. CDN에 존재하는 콘텐츠를 무효화하기 위해서 어떤 방식을 선택할 것인지 고려해야 합니다. 
- 예를 들어, 오브젝트 버저닝을 사용하거나 CDN 서비스에서 제공되는 API를 사용할 수 있습니다.



<br>

---

<br>


<br>


> ### 추가학습자료


라인개발실록 | CDN으로 무엇을 할 수 있나요? Content Delivery Network, CDN QnA ㅌ

출처 : https://www.youtube.com/watch?v=54PLQS4OS5E

<br>


물론입니다! 아래는 제공해주신 유튜브 스크립트 내용을 기반으로, 중요한 기능들을 빠짐없이 담고, 보기 좋게 정리한 CDN(Content Delivery Network) 기능 요약본입니다. 설명 중간에는 일상적인 예시나 비유를 덧붙여 쉽게 이해할 수 있도록 구성했습니다.

---

# ✅ CDN (Content Delivery Network) 기능 정리

> “CDN은 단순히 콘텐츠를 캐싱해서 빠르게 전달하는 것만이 아닙니다.  
> 마치 전 세계에 있는 나만의 프록시 서버를 자유롭게 활용할 수 있는 느낌이에요!”

---

## 🔹 기본 개념

- **CDN**은 콘텐츠를 전 세계 사용자에게 빠르고 안정적으로 전달하기 위해 `가장 가까운 엣지 서버(프록시 서버)`에 콘텐츠를 캐싱해두고 제공하는 네트워크 시스템입니다.
- 핵심 기능은 **캐싱(Caching)** 이지만, 그 외에도 다양한 고급 기능을 제공함.

---

## ⚙️ CDN의 주요 기능 (기초 + 고급)

### ✅ 1. 멀티 오리진(Multi-Origin)
- 하나의 도메인에서 **경로에 따라 다른 오리진 서버**로 요청을 라우팅할 수 있음.
- 예: `/api`는 API 서버로, `/images`는 이미지 스토리지로 보내기

> 📦 비유: 한 개의 택배창구에서 “이 서류는 민원실, 이 물건은 물류센터로” 자동 분류하는 느낌

---

### ✅ 2. 오리진 러버(Origin Rubber)
- 오리진 장애 시 자동으로 다른 오리진으로 라우팅하는 기능.
- DNS 레벨이 아닌 **HTTP 레이어**에서 처리된다는 점에서 Failover와 유사하지만 작동 계층이 다름.

> 🚧 비유: 내비게이션이 교통사고를 감지하고 즉시 우회도로로 경로를 바꿔주는 기능

---

### ✅ 3. 도메인 리디렉션
- 특정 도메인 접속 시, 다른 도메인으로 자동 이동시키는 기능.
- 예: `old.com` → `new.com`으로 자동 전환

> 🔁 비유: “이사했어요” 안내 문 붙인 가게처럼 자동으로 새 위치로 안내해주는 역할

---

### ✅ 4. 소리 컨텐츠 처리 (Sorry Content)
- 프라이머리 오리진이 장애 시, **사과 메시지 페이지**를 세컨더리 오리진에서 서빙함

> 📄 예시: “죄송합니다. 현재 서비스 이용이 어렵습니다” 라는 정적 HTML을 대신 보여줌

---

### ✅ 5. 인증 위임 (Auth Delegation)
- 콘텐츠 다운로드 전에 엣지 서버가 **원본 서버 대신 인증**을 처리할 수 있음
- 다운로드 전에 “이 사람 진짜 유료 사용자 맞아?” 확인하고, 맞으면 콘텐츠 전달

> 🔐 비유: 영화관 입장 전에 티켓 확인을 중앙에서 안 하고, 입구 직원이 대신 확인하는 것

---

### ✅ 6. 경로 리디렉션 (Path Redirection)
- 특정 URL 경로에 대한 요청을 **새로운 경로**로 리디렉션
- 예: `/campaign2023` → `/campaign2024`

> 🔀 비유: 행사장 위치가 바뀌었을 때, 구 주소로 온 사람을 새 장소로 안내하는 팻말

---

### ✅ 7. 지오 리디렉션 (Geo Redirection)
- 사용자 IP를 기준으로 **국가별로 다른 콘텐츠 제공**
- 한국 사용자는 `/kr`, 일본 사용자는 `/jp` 경로로 자동 전환

> 🌏 비유: 항공사 웹사이트에 접속하면 자동으로 나라에 맞는 언어와 페이지를 보여주는 기능

---

### ✅ 8. 접근 제어 (Access Control)
- IP나 위치 정보를 기반으로 **접근 허용 여부를 판단**해 차단 가능

> 🚫 비유: 클럽 입구에서 “신분증 확인하고 미성년자는 출입금지” 하는 것과 비슷

---

## 🛠 실전에서 발생할 수 있는 CDN 문제 & 해결법

### 📉 문제: 콘텐츠 다운로드 속도가 느리다?

#### ⛔ 원인 1. 캐싱 미적용
- CDN 서버에 아직 캐시가 안 된 상태일 수 있음
- 최초 요청 시 원본 서버에서 가져오는 시간이 더 걸림

✅ 해결:
- **프리 캐싱**: 서비스 런칭 전에 CDN에 콘텐츠를 미리 요청해 캐시를 채워놓는 방법
- 단, 실제 사용자가 없으면 캐시가 **셋션(eviction)**될 수 있음

---

#### ⛔ 원인 2. DNS 설정 오류
- 클라이언트는 한국에 있는데 DNS 리졸버가 미국에 있다면 → CDN은 미국 서버로 라우팅

✅ 해결:
- 클라이언트의 **DNS 위치를 점검**하고, 지역에 맞는 DNS 서버를 사용하게 유도

---

#### ⛔ 원인 3. 캐시 키 문제
- 캐시 키에 쿼리 스트링이 모두 포함되면 → 매번 “다른 요청”처럼 처리되어 캐시 미적용

✅ 해결:
- 꼭 필요한 쿼리 스트링만 캐시 키에 포함되도록 설정

> 📎 예시: 디버깅을 위해 붙인 `?debug=true` 같은 파라미터가 실서비스에 포함되면, 캐싱이 되지 않고 원본 요청이 계속 발생하게 됨

---

## 🧨 실전 트러블슈팅 사례: 콘텐츠 반반 깨짐 현상

- 한 파일이 **청크 단위**로 나뉘어 전송됨
- 퍼지(Fetch 후 무효화)를 하지 않고 오리진에 새 콘텐츠를 업로드
- 캐시가 섞여서 “앞은 옛날 콘텐츠, 뒤는 새 콘텐츠” 조합이 생김
- 클라이언트에서는 압축이 풀리지 않고 콘텐츠가 깨짐

✅ 교훈:
- 큰 파일 업로드 후에는 반드시 **퍼지 작업** 필수  
- 콘텐츠 캐싱은 “한 덩어리”로 보기 때문에 **청크 단위 캐싱의 일관성**을 항상 고려해야 함

---

## ⏳ TTL 전략 (캐시 수명 설정)

- **정적 콘텐츠 (JS, CSS, 이미지 등)**: 무조건 **긴 TTL (예: 365일)**
- **변경 가능성이 있는 콘텐츠**: **짧은 TTL (예: 10분)** + 퍼지 기능 활용
- **TTL 설정 팁**:
  - 과도한 쿼리 파라미터 포함은 캐시 효율을 떨어뜨림
  - 꼭 필요한 파라미터만 키에 포함시키기

---

## 📌 CDN의 장점 요약

| 기능 | 설명 | 비유 |
|------|------|------|
| 캐싱 | 콘텐츠를 엣지에 저장 후 빠르게 제공 | 집 근처 편의점에 재고를 미리 쌓아두는 것 |
| 리디렉션 | 도메인/경로 변경 시 자동 이동 | 이사한 가게 안내판 |
| 인증 위임 | 엣지에서 인증 수행 | 입장권 확인을 입구에서 대신 |
| 지오 기반 서비스 | 지역에 맞는 콘텐츠 제공 | 다국어 홈페이지 자동 설정 |
| 장애 대응 | 오리진 장애 시 다른 서버에서 콘텐츠 제공 | 비상 탈출구 같은 백업 경로 |

---

## ✅ 마무리 요약

> CDN은 단순한 속도 향상 도구가 아닙니다.  
> 다양한 캐싱 전략, 리디렉션, 인증, 접근 제어 등 **엣지 레벨에서 똑똑하게 분산된 프록시**로써  
> 웹서비스를 더 빠르고, 안정적이며, 유연하게 만들어주는 핵심 인프라입니다.

---



  

